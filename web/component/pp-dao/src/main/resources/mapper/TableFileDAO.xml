<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pp.dao.TableFileDAO">
    <resultMap id="BaseResultMap" type="com.pp.entity.dao.dto.TableFileDTO">
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="file_record_id" jdbcType="BIGINT" property="fileRecordId"/>
        <result column="file_name" jdbcType="VARCHAR" property="fileName"/>
    </resultMap>

    <select id="selectByTable" resultMap="BaseResultMap">
        select
        id,
        file_record_id,
        file_name
        from table_file
        where file_name = #{fileName}
        and file_id = #{fileId}
        and type = #{type}
        and flag = 1
    </select>

    <insert id="insert" parameterType="com.pp.entity.dao.table.TableFile">
        insert into table_file (
        id,
        `table_name`,
        table_id,
        file_record_id,
        file_name,
        `type`,
        flag,
        create_time
        )
        values (
        #{id,jdbcType = BIGINT},
        #{tableName,jdbcType = VARCHAR},
        #{tableId,jdbcType = BIGINT},
        #{fileRecordId,jdbcType = BIGINT},
        #{fileName,jdbcType = VARCHAR},
        #{type,jdbcType = TINYINT},
        #{flag,jdbcType = BIT},
        #{createTime,jdbcType = TIMESTAMP}
        )
    </insert>

    <update id="updateFlag">
        update table_file set flag = #{flag} where id = #{id}
    </update>
</mapper>